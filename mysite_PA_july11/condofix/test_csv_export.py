
# -*- coding: utf-8 -*-

import pandas as pd
import datetime
import csv


csv_list=[(22, 3, 'None', 4, 4, 'Vérification des transfos chopchop', datetime.date(2021, 4, 1), datetime.date(2021, 4, 23), 13, '', ('3.4'), ('12.3'), 'Jac-2/455678900', ('1995.50'), 1225, 510, None, 3, 'Salle mécanique', "('Elka Electrique',)", "('Ferme',)", "('Non-prioritaire : 15 j.',)", "('Electricite',)", "('Preventif',)", 0), (73, 21, '', 4, 1, 'Faire le nécessaire # 1', datetime.date(2021, 5, 27), datetime.date(2021, 5, 30), 13, '75', ('2.0'), ('1.5'), '432543', ('32.00'), 25, 0, 1, 1, 'Là…', "('JAL-Reparation generale',)", "('Ferme',)", "('Critique : 4 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (79, 22, '', 4, 1, 'Faire le nécessaire # 8', datetime.date(2021, 5, 27), datetime.date(2021, 5, 27), 13, '83', ('15.0'), ('12.0'), 'Gin-12345', ('1550.00'), 1200, 150, 1, 1, 'Kekpar', "('Les Entreprises Services Inc',)", "('Ferme',)", "('Critique : 4 h.',)", "('Electricite',)", "('Entretien et reparations',)", 69), (127, 3, '', 4, 3, 'entretien reparations', datetime.date(2021, 7, 3), datetime.date(2021, 6, 28), 13, '', ('4.0'), ('5.5'), 'Elka-5867', ('57.50'), 50, 0, 1, 1, 'salle de reception', "('Elka Electrique',)", "('Ferme',)", "('Moyenne : 5 j.',)", "('Electricite',)", "('Entretien et reparations',)", 0), (133, 3, '', 4, 4, 'Vérifier branchement ', datetime.date(2021, 7, 14), datetime.date(2021, 6, 29), 13, '76', ('12.0'), ('10.0'), 'Elka-5756', ('57.50'), 25, 25, 1, 1, 'Garage', "('Elka Electrique',)", "('Ferme',)", "('Non-prioritaire : 15 j.',)", "('Electricite',)", "('Entretien et reparations',)", 62), (144, 21, '', 4, 2, 'Je ne sais pas c’est quoi le problème', datetime.date(2021, 7, 7), datetime.date(2021, 7, 5), 13, '75', ('1.5'), ('2.5'), '4346u90/544677', ('19.06'), 10, 6, 1, 1, '', "('JAL-Reparation generale',)", "('Ferme',)", "('Elevee: 48 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (152, 3, 'None', 4, 4, 'Vérification des transfos', datetime.date(2021, 8, 1), datetime.date(2021, 9, 29), 13, '', ('2.0'), ('3.0'), 'Elka-5867', ('575.00'), 500, 0, 2, 3, 'Salle mécanique', "('Elka Electrique',)", "('Ferme',)", "('Non-prioritaire : 15 j.',)", "('Electricite',)", "('Preventif',)", 0), (379, 21, '', 4, 1, 'Faire le nécessaire # 1', datetime.date(2021, 5, 27), datetime.date(2021, 5, 30), 13, '75', ('2.0'), ('1.5'), None, ('0.00'), 0, 0, 1, 1, 'Là…', "('JAL-Reparation generale',)", "('Ferme',)", "('Critique : 4 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (380, 21, '', 4, 1, 'Faire le nécessaire # 1', datetime.date(2021, 5, 27), datetime.date(2021, 5, 30), 13, '75', ('2.0'), ('1.5'), None, ('0.00'), 0, 0, 1, 1, 'Là…', "('JAL-Reparation generale',)", "('Ferme',)", "('Critique : 4 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (391, 3, '', 4, 3, 'Le panneau annonciateur de l’entrée principale ne fonctionne plus. Vérifier et réparer.', datetime.date(2022, 1, 16), datetime.date(2022, 2, 15), 13, '99', ('3.0'), ('4.0'), '1234', ('115.00'), 100, 0, 1, 1, 'Entrée principale', "('Elka Electrique',)", "('Ferme',)", "('Moyenne : 5 j.',)", "('Electricite',)", "('Entretien et reparations',)", 85), (395, 3, '', 4, 1, 'Les lumières du 2e étage ne fonctionnent plus.// Réparation: Le breaker était sauté.', datetime.date(2022, 1, 12), datetime.date(2022, 8, 28), 13, '0', ('5.0'), ('2.0'), 'Elka-9876/987/333/Elka-987987', ('575.00'), 277, 774, 1, 4, '', "('Elka Electrique',)", "('Ferme',)", "('Critique : 4 h.',)", "('Electricite',)", '("Projet d\'amelioration",)', 0), (406, 3, '', 4, 3, 'Vérification annuelle', datetime.date(2022, 1, 31), datetime.date(2022, 1, 29), 13, '75', ('5.0'), ('2.0'), '123456', ('230.00'), 100, 0, 1, 1, 'Chambre électrique', "('Elka Electrique',)", "('Ferme',)", "('Moyenne : 5 j.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (408, 3, '', 4, 3, 'Vérification annuelle', datetime.date(2022, 1, 31), datetime.date(2022, 1, 29), 13, '76', ('5.0'), ('2.0'), '656565', ('230.00'), 100, 100, 1, 1, 'Chambre électrique', "('Elka Electrique',)", "('Ferme',)", "('Moyenne : 5 j.',)", "('Electricite',)", "('Entretien et reparations',)", 62), (472, None, '', 3, 1, 'Les lumières du 2e étage ne fonctionnent plus.// Réparation: Le breaker était sauté.', datetime.date(2022, 1, 12), datetime.date(2022, 2, 28), 13, '0', ('5.0'), ('2.0'), 'Elka-9876/987/333/Elka-987987', ('575.00'), 277, 774, 1, 1, '', 'Nil', "('Attente facture',)", "('Critique : 4 h.',)", "('Electricite',)", "('Entretien et reparations',)", 0), (481, 3, '', 4, 2, 'Test du multitags', datetime.date(2022, 3, 7), datetime.date(2022, 3, 5), 13, '75', ('1.0'), ('1.5'), 'Elka-001', ('115.00'), 80, 20, 2, 1, 'Salle électrique', "('Elka Electrique',)", "('Ferme',)", "('Elevee: 48 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (482, 3, '', 4, 2, 'Test du multitags', datetime.date(2022, 3, 7), datetime.date(2022, 3, 5), 13, '76', ('2.0'), ('2.0'), 'Elka-002', ('115.00'), 20, 80, 2, 1, 'Salle électrique', "('Elka Electrique',)", "('Ferme',)", "('Elevee: 48 h.',)", "('Electricite',)", "('Entretien et reparations',)", 62), (483, 21, 'Joe Soucis', 4, 2, 'Bbb', datetime.date(2022, 3, 8), datetime.date(2022, 3, 6), 13, '75', ('2.0'), None, None, ('0.00'), 0, 0, 2, 1, '', "('JAL-Reparation generale',)", "('Ferme',)", "('Elevee: 48 h.',)", "('Electricite',)", "('Entretien et reparations',)", 61), (484, 3, 'Joe Bine', 3, 2, 'Bbb', datetime.date(2022, 3, 8), datetime.date(2022, 3, 6), 13, '0', ('2.0'), ('3.0'), None, ('0.00'), 0, 0, 2, 1, '', "('Elka Electrique',)", "('Attente facture',)", "('Elevee: 48 h.',)", "('Electricite',)", "('Entretien et reparations',)", 0), (516, 3, None, 2, 4, 'Vérification des transfos', datetime.date(2022, 4, 1), None, 13, '0', ('2.0'), None, None, ('0.00'), 0, 0, 2, 3, 'Salle mécanique', "('Elka Electrique',)", "('En cours',)", "('Non-prioritaire : 15 j.',)", "('Electricite',)", "('Preventif',)", 0), (595, 3, None, 2, 4, 'Vérification des transfos', datetime.date(2022, 8, 1), None, 13, '0', ('2.0'), None, None, ('0.00'), 0, 0, 3, 3, 'Salle mécanique', "('Elka Electrique',)", "('En cours',)", "('Non-prioritaire : 15 j.',)", "('Electricite',)", "('Preventif',)", 0)]
with open('test_1.csv', 'w', newline='',encoding='utf-8') as csvfile:
    w = csv.writer(csvfile, delimiter=',')
    entetes = ['No. Ticket', 'Statut', 'Priorite', 'Description du travail', 'Emplacement', 'Date Prevue',
               'Date Complet', 'Categorie', 'Tag Equipement',
               'Heures estimees', 'Heures requises', 'Intervenant', 'Intervenant si autre', 'Nos. Factures',
               'Cout total TTC', 'Cout MainOeuvre',
               'Cout Materiel', 'IDUsager', 'Type de travail','entete_1','entete_1','entete_1','entete_1','entete_1','entete_1']
    w.writerow(entetes)
    for item in csv_list:
        w.writerow(item)
df_csv=pd.read_csv("test_1.csv", engine='python', index_col=0)
# on vérifie le nombre de (lignes, colonnes)
content=df_csv.shape
df_csv2=df_csv.head(content[0]+1)
df_csv2.to_csv("C:/Users/Donal/Downloads/test_1.csv",encoding = 'utf-8-sig')
